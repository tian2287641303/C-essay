# C++工作原理
C++将源文件转换成可执行文件共分两个步骤
1. 编译(编译器工作)
2. 链接(链接器工作)
  
        源文件-->编译器工作编译成目标文件，在vs中为obj文件-->链接器工作将所有的obj文件链接到一起生成可执行文件
## C++编译器
### C++编译器主要功能
将文本文件(为了让编译器知道需要编译的文本文件有哪些,将这些需要编译的文本文件后缀名写为.cpp文件)转换为目标文件(obj文件)

编译器会将所有的源文件编译成目标文件，但不会编译头文件等其他文件(因为预处理会将所有用户需要的文本内容拷贝到了源文件当中一起编译)

编译器会优先处理预处理语句，在实际编译之前。

编译器会将每一个源文件变成一个翻译单元，翻译单元生成一个目标文件(一般来说，但不一定，也可以在一个源文件中include另一个源文件就只会有一个翻译单元，也就只会有一个.obj目标文件)

### C++编译主要步骤
+ 处理所有的预处理代码
+ 记号化和解析文本内容
+ 将代码转换为常量和指令，生成抽象语法树(生成实际代码)让cpu执行生成的代码，还会获取常量，变量的存储区。

### C++预处理
先介绍一下**#**，在C++中**#**之后的语句都是预处理语句
#### #include
**include**后接文件名，作用是将该文件的所有内容拷贝到当前文件**include**所在位置(这里值得注意的是我们在实际工作过程中有时会遇到的重复定义问题就是由这个特性引起的)

最好将函数的定义都放在翻译单元中，在头文件中只有函数声明。可以减少重复定义问题的发生。
#### #define
**define**宏定义，作用是将一个标识符定义为一个字符串，也可以理解为起别名。
#### C++条件编译
##### #if
作用是如果**if**后跟条件语句成立则编译到#endif为止的程序段，否则直接跳过该段不编译。
##### #ifdef
作用是如果**ifdef**后跟的值宏定义过则编译到#endif为止的程序段，否则直接跳过该段不编译。
##### #ifndef
作用是如果**ifndef**后跟的值宏定义过则编译到#endif为止的程序段，否则直接跳过该段不编译。
#### 预处理文件
vs可以生成预处理过后的预处理文件，后缀名为.i格式,但生成预处理文件的源文件vs默认不会生成目标文件，如果bulid的话会造成链接错误(无法打开obj文件)

### 汇编文件
**.ASM**汇编文件后缀名
### C++编译报错
C++所有在编译阶段发生的error都是以C打头提示用户的。
## C++链接器
### C++链接器主要功能
找到每个函数和符号的所在位置，并将他们连接起来(会在obj文件和lib文件中寻找最终生成可执行文件或库文件)
### 函数声明
函数声明是依赖链接器实现的，当用户声明了一个函数时，编译器会相信用户，不会管函数到底在哪？编译会成功，链接器会找到函数定义并导入函数声明处，但如果并没有找到函数定义，会产生链接失败。 
### C++链接报错
C++所有在链接阶段发生的error都是以LNK打头提示用户的。

无法解析的外部符号是指链接器无法解析当前符号，并没有当前符号的定义。
## main函数小知识
C++程序入口是main函数，但只是C++编译器默认设置为main函数而以，但可以在vs中修改。
当int main函数没有return返回值时，会默认返回0。